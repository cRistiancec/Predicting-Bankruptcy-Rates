---
title: "Forecasting National Bankruptcy Rates"
author: "Sheri Nguyen, Juan Pablo Oberhauser, Evelyn Peng"
date: "November 27, 2016"
output:
  pdf_document:
    toc: true
    toc_depth: 2
    fig_caption: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(dplyr)
library(ggplot2)
```


#Problem Description

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; According to the Office of the Superintendent of Bankruptcy Canada, "The consumer insolvency rate is defined as the number of consumer insolvencies per thousand residents aged 18 years or above." Bankruptcy rates have gained prevalence and importance sine the 2008 economic downturn since most of the issues arising in that time came from unpaid mortgages and the bundling of sub-prime loans that were unpaid. Being able to accurately predict economic indicators is paramount to understand and prepare for many macro- and micro-economic events. 


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; We are to utilize bankruptcy rates from the country of Canada from January 1987 to December 2010 to try and forecast this same economic indicator into the future. Figure 1 below showcases said economic indicator through time. We can see that the indicator is volatile, has a clear upward trend, has some spikes (likely due to external economic )

```{r}
df <- read.csv("train.csv")
time_s <- df %>% dplyr::select(Bankruptcy_Rate) %>% ts()
##re-format date so we cna plot using ggplot
df$Date <-zoo::as.Date(zoo::as.yearmon(sprintf("%06s",as.character(df$Month)), "%m%Y"))
```


```{r, fig.width=12,fig.height=4, fig.cap = "January 2011 â€“ December 2012 bankruptcy rates"}
ggplot(df, aes(Date, Bankruptcy_Rate)) + geom_line()  + xlab("") + ylab("Bankruptcy Rates") + ggtitle("Canadian Bankruptcy Rates ") 
```


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Given that most of the bankruptcy filings are caused by economic downturns, it is no surprise that there is seasonality and trend in the data, and it is also not surprising that the largest bankruptcy rates are seen at the end of 2008 and beginning of 2009. 




#Methods to Solve Problem

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The main idea behind the approach to solve the problem of forecasting bankruptcy rates into the future is to exploit the fact that the bankruptcy rate tomorrow is very likely to be similar to that of today. Similarly, we can exploit the fact that the rate today is likely to be very similar to that of yesterday. Furthemore, we can exploit other relationships in the data to gain insights into the future like the fact that bankruptcy rates in July tend to go up or that every January sees a decline in bakruptcy rates. We will now use plots and other metrics to see which are these kinds of relationships in the data and once we extract them, use them to predict into the future. 

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Furthermore, we can use other data that highly correlates to bankruptcy rates as external regressors. For example, if we know from economic theory that bankruptcy rates spike after people have a hard time paying off their debt, we can use other indicators like the House Price Index to tell us whether the bankrupcty rates are likely to go up or down when the House Price Index moves up or down. We will further explore these extrenal regressors in the Final Method section to see if they should be included in a model to predict future bankruptcy rates. 

## External Regressors

```{r, fig.width=12,fig.height=4, fig.cap = "Scaled Bankruptcy & Unemployment Rates"}
ggplot(df, aes(Date, scale(Bankruptcy_Rate))) + geom_line()  + xlab("") + ylab("Bankruptcy Rates") + ggtitle("Scaled Bankruptcy & Unemployment Rates") + geom_line(aes(Date, scale(Unemployment_Rate)), colour="red")
```



#Final Method Chosen 

# Results





As we can see in Figure 1 which shows the original time series of monthly bankruptcy rates in Canada from January 1987- December 2010, we see there is a clear upward trend. Moreover, there is some visual evidence of seasonality and increasing variance or volatility in the bankruptcy rates. 


## Technical Appendix